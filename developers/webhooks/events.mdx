---
title: "Events"
description: "Types of possible events that Pandabase can send to your application."
---

This is a list of all the types of events we currently send. Each event is delivered to your configured webhook URL with a JSON payload.

## Webhook structure

Every webhook delivery is a `POST` request with a JSON body. The top-level structure contains an `object` field and an `event` object with the event `type`, the order `id`, a `created_at` timestamp, and a `data` object with the event-specific payload.

<CodeGroup>

```json Example Event
{
  "object": "payment",
  "event": {
    "type": "payment.success",
    "id": "ord_abc123",
    "created_at": 1707400000000,
    "data": {
      "order": {
        "id": "ord_abc123",
        "order_number": "inv_xyz789",
        "status": "PROCESSING",
        "amount": 2999,
        "currency": "USD",
        "gateway": "STRIPE",
        "custom_fields": [
          {
            "key": "discord_username",
            "label": { "type": "custom", "custom": "Discord Username" },
            "type": "text",
            "optional": false,
            "text": { "minimum_length": 2, "maximum_length": 50 },
            "value": "johndoe"
          }
        ]
      },
      "transaction": {
        "id": "txn_def456",
        "transaction_id": "pi_stripe_xxx",
        "status": "SUCCESS",
        "amount": 3199,
        "fee": 200,
        "currency": "USD",
        "method": "STRIPE"
      }
    }
  }
}
```

```typescript Type Definition
type WebhookPayload = {
  object: "payment";
  event: {
    type: WebhookEventType;
    id: string;
    created_at: number;
    data: {
      order?: {
        id: string;
        order_number: string;
        status: string;
        amount: number;
        currency: string;
        gateway: string;
        custom_fields?: CustomField[];
      };
      transaction?: {
        id: string;
        transaction_id: string;
        status: string;
        amount: number;
        fee: number;
        currency: string;
        method: string;
      };
      customer?: {
        email: string;
      };
    };
  };
};

type WebhookEventType =
  | "payment.pending"
  | "payment.success"
  | "payment.paid"
  | "payment.not_paid"
  | "payment.refunded"
  | "payment.disputed";
```

</CodeGroup>

## Webhook headers

Every webhook delivery includes the following headers:

| Header | Description |
|--------|-------------|
| `X-Pandabase-Signature` | HMAC-SHA256 hex digest of the JSON body, signed with your webhook secret |
| `X-Pandabase-Timestamp` | Unix timestamp (milliseconds) of when the delivery was sent |
| `X-Pandabase-Idempotency` | Unique delivery identifier for deduplication |
| `Content-Type` | Always `application/json` |
| `User-Agent` | `Pandabase (https://pandabase.io)` |

## Verifying signatures

Verify the `X-Pandabase-Signature` header to ensure the webhook was sent by Pandabase and not tampered with.

```typescript
import crypto from "crypto";

function verifySignature(body: string, signature: string, secret: string): boolean {
  const expected = crypto
    .createHmac("sha256", secret)
    .update(body)
    .digest("hex");

  return expected === signature;
}
```

## Retries

Failed webhook deliveries are retried up to **5 times** with exponential backoff starting at 1 second. Your endpoint should return a `2xx` status code to acknowledge receipt. Any other status code or a timeout (15 seconds) is treated as a failure.

## Payment events

### `payment.pending`

Occurs when a payment intent is created and awaiting customer action. This is the first event fired when a customer proceeds to pay.

**Data included:** `order`, `transaction`, `customer`

### `payment.success`

Occurs when a payment is successfully processed. This is the primary event to listen for when fulfilling orders.

**Data included:** `order`, `transaction`

<Note>
  The `order.custom_fields` array is included in the `payment.success` event if
  the checkout session had custom fields defined. Each field contains both the
  definition and the customer's submitted `value`.
</Note>

### `payment.paid`

Occurs when a payment has been confirmed as paid by the payment provider.

**Data included:** `transaction`

### `payment.not_paid`

Occurs when a payment fails or expires without being completed.

**Data included:** `order`, `transaction`

### `payment.refunded`

Occurs when a payment is refunded, either partially or in full.

**Data included:** `transaction`

### `payment.disputed`

Occurs when a customer opens a dispute (chargeback) on a payment.

**Data included:** `transaction`
